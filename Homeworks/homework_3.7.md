# Домашнее задание к занятию "3.7. Компьютерные сети.Лекция 2"

### Цель задания

В результате выполнения этого задания вы:

1. Познакомитесь с инструментами настройки сети в Linux, агрегации нескольких сетевых интерфейсов, отладки их работы.
2. Примените знания о сетевых адресах на практике для проектирования сети.


### Инструкция к заданию

1. Создайте .md-файл для ответов на задания в своём репозитории, после выполнения прикрепите ссылку на него в личном кабинете.
2. Любые вопросы по выполнению заданий спрашивайте в чате учебной группы и/или в разделе “Вопросы по заданию” в личном кабинете.


### Инструменты/ дополнительные материалы, которые пригодятся для выполнения задания

1. [Калькулятор сетей online](https://calculator.net/ip-subnet-calculator.html).
2. Калькулятор сетей программа - ipcalc (`apt install ipcalc`), если есть графический интерфейс, то у программы калькулятора есть инженерный режим, там можно и сети считать.


------

## Задание

1. Проверьте список доступных сетевых интерфейсов на вашем компьютере. Какие команды есть для этого в Linux и в Windows?

### Ответ
Увидеть список доступных сетевых интерфейсов на компьютере можно с помощью команд:  
в Linux  
`ifconfig` -  выдает информацию о состоянии активных интерфейсов (в современных дистрибутивах Linux команда устарела и заменена `iproute2`, основные функции настроек сетевого интерфейса получила утилита `ip` из состава `iproute2`)  
`ip link` - состояние интерфейсов  
`ip address` - IP адреса интерфейсов  
`ip route` - таблица маршрутизации  
в Windows  
`ipconfig /all` - отобразить полную конфигурацию настроек TCP/IP для всех сетевых адаптеров  
`GETMAC /FO csv`  - выдать информации о MAC-адресах всех существующих на локальном компьютере сетевых адаптеров в формате CSV  
`route print` - отобразить текущую таблицу маршрутов  
`netstat -a` - отображение всех активных соединений по протоколам TCP и UDP, а также, списка портов, которые ожидают входящие соединения (слушаемых портов).

2. Какой протокол используется для распознавания соседа по сетевому интерфейсу? Какой пакет и команды есть в Linux для этого?

### Ответ
LLDP (Link Layer Discovery Protocol) - протокол канального уровня, который позволяет сетевым устройствам анонсировать в сеть информацию о себе и о своих возможностях, а также собирать эту информацию о соседних устройствах.  
В Linux есть соответствующий пакет `lldpd` (необходима установка с помощью `sudo apt install lldpd`).  
Просмотреть информацию о LLDP-соседях можно с помощью команды: `sudo lldpctl`.  
`sh lldp i r 1` - посмотреть, как видна Linux-машина на коммутаторе, в расширенном виде: MAC-адрес, имя хоста, интерфейс, которым хост подключен к коммутатору, версия ядра, IP-адрес системы и т.д.

3. Какая технология используется для разделения L2 коммутатора на несколько виртуальных сетей? Какой пакет и команды есть в Linux для этого? Приведите пример конфига.

### Ответ
Для разделения L2 коммутатора на несколько виртуальных сетей используется VLAN (Virtual Local Area Network).  
В Linux есть соответствующий пакет `vlan` (необходима установка с помощью `sudo apt install vlan`).  
Настройки подынтерфейсов VLANов точно так же, как и для сетевых интерфейсов, указываются в `/etc/network/interfaces`. Пример конфига для VLANов:
```
auto vlan1400
iface vlan1400 inet static
      address 192.168.1.1
      netmask 255.255.255.0
      vlan_raw_device eth0
auto eth0.1400
iface eth0.1400 inet static
      address 192.168.1.1
      netmask 255.255.255.0
      vlan_raw_device eth0
```
Вручную настройка VLAN выполняется с помощью команды `vconfig`. `vconfig` позволяет создавать и удалять VLAN-устройства (vlan-devices) в системе с ядром, поддерживающим 802.1Q VLAN'ы. Устройства vlan-devices это виртуальные Ethernet-устройства, представляющие отдельные VLAN'ы физической сети.

4. Какие типы агрегации интерфейсов есть в Linux? Какие опции есть для балансировки нагрузки? Приведите пример конфига.

### Ответ
Агрегирование каналов (агрегация каналов, link aggregation) - технология, которая позволяет объединить несколько физических каналов в один логический. Такое объединение позволяет увеличивать пропускную способность и надежность канала. Агрегирование каналов может быть настроено между двумя коммутаторами, коммутатором и маршрутизатором, между коммутатором и хостом.  
Есть два типа агрегирования: статическое и динамическое. При динамическом агрегировании для управления агрегированным каналом используется стандартный протокол LACP (Link Aggregation Control Protocol).  
Для работы с LAG в linux необходим пакет `ifenslave` (установка с помощью `sudo apt install ifenslave`). Метод агрегации нескольких сетевых интерфейсов в единый логический интерфейс обеспечивает драйвер bonding ядра linux. Поведение агрегированных ("bonded") интерфейсов зависит от режима ("mode").  
Имеются следующие опции балансировки нагрузки:  
Mode-0(balance-rr) - Данный режим используется по умолчанию. Balance-rr обеспечивается балансировку нагрузки и отказоустойчивость. В данном режиме сетевые пакеты отправляются “по кругу”, от первого интерфейса к последнему. Если выходят из строя интерфейсы, пакеты отправляются на остальные оставшиеся. Дополнительной настройки коммутатора не требуется при нахождении портов в одном коммутаторе. При разностных коммутаторах требуется дополнительная настройка.  
Mode-1(active-backup) - Один из интерфейсов работает в активном режиме, остальные в ожидающем. При обнаружении проблемы на активном интерфейсе производится переключение на ожидающий интерфейс. Не требуется поддержки от коммутатора.  
Mode-2(balance-xor) - Передача пакетов распределяется по типу входящего и исходящего трафика по формуле ((MAC src) XOR (MAC dest)) % число интерфейсов. Режим дает балансировку нагрузки и отказоустойчивость. Не требуется дополнительной настройки коммутатора/коммутаторов.  
Mode-3(broadcast) - Происходит передача во все объединенные интерфейсы, тем самым обеспечивая отказоустойчивость. Рекомендуется только для использования MULTICAST трафика.  
Mode-4(802.3ad) - Динамическое объединение одинаковых портов. В данном режиме можно значительно увеличить пропускную способность входящего так и исходящего трафика. Для данного режима необходима поддержка и настройка коммутатора/коммутаторов.  
Mode-5(balance-tlb) - Адаптивная балансировки нагрузки трафика. Входящий трафик получается только активным интерфейсом, исходящий распределяется в зависимости от текущей загрузки канала каждого интерфейса. Не требуется специальной поддержки и настройки коммутатора/коммутаторов.  
Mode-6(balance-alb) - Адаптивная балансировка нагрузки. Отличается более совершенным алгоритмом балансировки нагрузки, чем Mode-5. Обеспечивается балансировка нагрузки как исходящего так и входящего трафика. Не требуется специальной поддержки и настройки коммутатора/коммутаторов.  
Настройки указываются также в `/etc/network/interfaces`. Пример конфига:
```
auto bond0
iface bond0 inet static
    address 10.31.1.5
    netmask 255.255.255.0
    network 10.31.1.0
    gateway 10.31.1.254
    bond-slaves eth0 eth1
    bond-mode active-backup
    bond-miimon 100
    bond-downdelay 200
    bond-updelay 200
```

5. Сколько IP адресов в сети с маской /29 ? Сколько /29 подсетей можно получить из сети с маской /24. Приведите несколько примеров /29 подсетей внутри сети 10.10.10.0/24.

### Ответ
В сети с маской /29 8 IP адресов.  
Из сети с маской /24 можно получить 32 /29 подсети.  
Примеры /29 подсетей внутри сети 10.10.10.0/24:   
10.10.10.(0-7)/29  
10.10.10.(112-119)/29  
10.10.10.(248-255)/29

6. Задача: вас попросили организовать стык между 2-мя организациями. Диапазоны 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16 уже заняты. Из какой подсети допустимо взять частные IP адреса? Маску выберите из расчета максимум 40-50 хостов внутри подсети.

### Ответ
IP адреса в данном случае допустимо взять из подсети 100.64.0.0/26 (100.64.0.0-100.64.0.63).

7. Как проверить ARP таблицу в Linux, Windows? Как очистить ARP кеш полностью? Как из ARP таблицы удалить только один нужный IP?

### Ответ
Проверить ARP таблицу можно с помощью команд: `ip neigh` - в Linux, `arp -a` - в Windows.  
Очистить ARP кеш полностью можно с помощью команды: `sudo ip neigh flush all`.  
Только один нужный IP из ARP таблицы можно удалить с помощью опции del: `sudo ip neigh del 10.0.2.2 dev eth0`.

*В качестве решения ответьте на вопросы и опишите, каким образом эти ответы были получены*

---

## Задание для самостоятельной отработки* (необязательно к выполнению)

 8. Установите эмулятор EVE-ng.
 
 [Инструкция по установке](https://github.com/svmyasnikov/eve-ng)

 Выполните задания на lldp, vlan, bonding в эмуляторе EVE-ng. 
 
----

### Правила приема домашнего задания

В личном кабинете отправлена ссылка на .md файл в вашем репозитории.


### Критерии оценки

Зачет - выполнены все задания, ответы даны в развернутой форме, приложены соответствующие скриншоты и файлы проекта, в выполненных заданиях нет противоречий и нарушения логики.

На доработку - задание выполнено частично или не выполнено, в логике выполнения заданий есть противоречия, существенные недостатки. 
 
Обязательными к выполнению являются задачи без указания звездочки. Их выполнение необходимо для получения зачета и диплома о профессиональной переподготовке.
Задачи со звездочкой (*) являются дополнительными задачами и/или задачами повышенной сложности. Они не являются обязательными к выполнению, но помогут вам глубже понять тему.